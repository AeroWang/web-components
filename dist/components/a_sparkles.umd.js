(function(s){typeof define=="function"&&define.amd?define(s):s()})(function(){"use strict";var b=Object.defineProperty;var w=(s,a,l)=>a in s?b(s,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[a]=l;var o=(s,a,l)=>(w(s,typeof a!="symbol"?a+"":a,l),l);const s=(i,n)=>Math.floor(Math.random()*(n-i))+i;function a(i,n=void 0,e=1){const t=[];typeof n>"u"&&(n=i,i=0);for(let r=i;r<n;r+=e)t.push(r);return t}function l(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}const _=i=>window.matchMedia(i).matches,c=(i,n={timeId:null},e,t)=>{if(typeof e=="number"&&typeof t=="number"){const r=()=>{const h=s(e,t);n.timeId=window.setTimeout(()=>{i(),r()},h)};r()}else window.clearTimeout(n.timeId)},g=".sparkles-box{position:relative;display:inline-block;box-sizing:border-box;cursor:pointer}.single-sparkle-box{position:absolute;transform:translate3d(-50%,-50%,0);color:orange;pointer-events:none}.slot{position:relative;z-index:5}@media (prefers-reduced-motion: no-preference){.single-sparkle-box{animation:comeInout .6s ease-in-out forwards}.single-sparkle-box svg{animation:spin .6s ease-in-out forwards}}@keyframes comeInout{0%{transform:scale(0)}50%{transform:scale(1)}to{transform:scale(0)}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(180deg)}}",f=(i=!1,n=[],e,t)=>({id:String(s(1e4,99999)),createdAt:Date.now(),size:s(10,17),style:{color:n.length?n[s(0,n.length)]:void 0,top:`${s(e[0],e[1])}%`,left:`${s(t[0],e[1])}%`,zIndex:(i?1:s(1,8)).toString()}}),u="(prefers-reduced-motion: no-preference)";class y extends HTMLElement{constructor(){super();o(this,"_mediaQueryList",window.matchMedia(u));o(this,"_preferredReducedMotion",!_(u));o(this,"_sparklesBox");o(this,"_sparkles",[]);o(this,"_timeId",{timeId:null});o(this,"_shadow");o(this,"_randomColors");o(this,"_minDelay",300);o(this,"_maxDelay",800);o(this,"_leftOffsetRange",[-15,60]);o(this,"_topOffsetRange",[0,85]);this._shadow=this.attachShadow({mode:"closed"});const e=document.createElement("style");e.textContent=g,this._shadow.appendChild(e),this._sparklesBox=document.createElement("div"),this._sparklesBox.className="sparkles-box";const t=document.createElement("slot");t.setAttribute("class","slot"),this._sparklesBox.appendChild(t),this._shadow.appendChild(this._sparklesBox),this._randomColors=this.getAttribute("colors")?this.getAttribute("colors").split(",").map(d=>d.trim()):void 0;const r=this.getAttribute("left-offset-range")?this.getAttribute("left-offset-range").split(",").map(d=>d.trim()):[-15,60];this._leftOffsetRange=r.length===2?r:[-10,60];const h=this.getAttribute("top-offset-range")?this.getAttribute("top-offset-range").split(",").map(d=>d.trim()):[-15,60];if(this._topOffsetRange=h.length===2?h:[0,85],this._minDelay=this.getAttribute("min-delay")?Number(this.getAttribute("min-delay")):300,this._maxDelay=this.getAttribute("max-delay")?Number(this.getAttribute("max-delay"))<600?600:Number(this.getAttribute("max-delay")):800,this._preferredReducedMotion){const d=this.getAttribute("init-num"),m=document.createDocumentFragment();this._sparkles=a(s(0,Number(d))).map(()=>f(this._preferredReducedMotion,this._randomColors)),this._sparkles.forEach(p=>{this.generateSparkle(p),m.appendChild(this.generateSparkle(p))}),this._sparklesBox.appendChild(m)}this.reCreate=this.reCreate.bind(this),this.mediaListener=this.mediaListener.bind(this)}generateSparkle(e){const t=document.createElement("span");return t.className="single-sparkle-box",t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="${e.size}" height="${e.size}" viewBox="0 0 160 160" fill="none"><path fill="currentColor" d="M80 0s4.285 41.292 21.496 58.504C118.707 75.715 160 80 160 80s-41.293 4.285-58.504 21.496S80 160 80 160s-4.285-41.293-21.496-58.504C41.292 84.285 0 80 0 80s41.292-4.285 58.504-21.496C75.715 41.292 80 0 80 0z"></path></svg>`,t.style.color=e.style.color,t.style.top=e.style.top,t.style.left=e.style.left,t.style.zIndex=e.style.zIndex,t.id=e.id,t}mediaListener(e){if(e&&(this._preferredReducedMotion=!e.matches,this._preferredReducedMotion))return c(this.reCreate,this._timeId,null,null);this._preferredReducedMotion||c(this.reCreate,this._timeId,this._minDelay,this._maxDelay)}reCreate(){const e=f(!1,this._randomColors,this._leftOffsetRange,this._topOffsetRange),t=Date.now(),r=this._sparkles.filter(h=>{if(t-h.createdAt<this._maxDelay+50)return!0;{const m=this._shadow.getElementById(h.id);return m&&this._sparklesBox.removeChild(m),!1}});this._sparklesBox.appendChild(this.generateSparkle(e)),r.push(e),this._sparkles=[...r]}connectedCallback(){this.mediaListener(),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this.mediaListener):this._mediaQueryList.addListener(this.mediaListener)}disconnectCallback(){if(this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this.mediaListener):this._mediaQueryList.removeListener(this.mediaListener),typeof this._timeId=="number")return window.clearTimeout(this._timeId)}}if(l())customElements.define("a-sparkles",y);else throw new Error("仅在浏览器中可用")});
