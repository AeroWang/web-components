(function(s){typeof define=="function"&&define.amd?define(s):s()})(function(){"use strict";var b=Object.defineProperty;var w=(s,a,d)=>a in s?b(s,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):s[a]=d;var o=(s,a,d)=>(w(s,typeof a!="symbol"?a+"":a,d),d);const s=(n,r)=>Math.floor(Math.random()*(r-n))+n;function a(n,r=void 0,e=1){const t=[];typeof r>"u"&&(r=n,n=0);for(let i=n;i<r;i+=e)t.push(i);return t}function d(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}const _=n=>window.matchMedia(n).matches,c=(n,r={timeId:null},e,t)=>{if(typeof e=="number"&&typeof t=="number"){const i=()=>{const h=s(e,t);r.timeId=window.setTimeout(()=>{n(),i()},h)};i()}else window.clearTimeout(r.timeId)},g=".sparkles-box{position:relative;display:inline-block;box-sizing:border-box;cursor:pointer}.single-sparkle-box{position:absolute;transform:translate3d(-50%,-50%,0);color:orange;pointer-events:none}.slot{position:relative;z-index:5}@media (prefers-reduced-motion: no-preference){.single-sparkle-box{animation:comeInout .6s ease-in-out forwards}.single-sparkle-box svg{animation:spin .6s ease-in-out forwards}}@keyframes comeInout{0%{transform:scale(0)}50%{transform:scale(1)}to{transform:scale(0)}}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(180deg)}}",u=(n=!1,r=[],e="text",t,i)=>({id:String(s(1e4,99999)),createdAt:Date.now(),size:s(10,17),style:{color:r.length?r[s(0,r.length)]:void 0,top:`${s(i[0],i[1])}%`,left:`${s(t[0],t[1])}%`,zIndex:(e==="text"?n?1:s(1,8):6).toString()}}),f="(prefers-reduced-motion: no-preference)";class y extends HTMLElement{constructor(){super();o(this,"_mediaQueryList",window.matchMedia(f));o(this,"_preferredReducedMotion",!_(f));o(this,"_sparklesBox");o(this,"_sparkles",[]);o(this,"_timeId",{timeId:null});o(this,"_shadow");o(this,"_randomColors");o(this,"_minDelay",300);o(this,"_maxDelay",800);o(this,"_leftOffsetRange",[-15,60]);o(this,"_topOffsetRange",[0,85]);o(this,"_slotType","text");this._shadow=this.attachShadow({mode:"closed"});const e=document.createElement("style");e.textContent=g,this._shadow.appendChild(e),this._sparklesBox=document.createElement("div"),this._sparklesBox.className="sparkles-box";const t=document.createElement("slot");t.setAttribute("class","slot"),this._sparklesBox.appendChild(t),this._shadow.appendChild(this._sparklesBox),this._randomColors=this.getAttribute("colors")?this.getAttribute("colors").split(",").map(l=>l.trim()):void 0;const i=this.getAttribute("left-offset-range")?this.getAttribute("left-offset-range").split(",").map(l=>Number(l.trim())):[-15,60];this._leftOffsetRange=i.length===2?i:[-10,60];const h=this.getAttribute("top-offset-range")?this.getAttribute("top-offset-range").split(",").map(l=>Number(l.trim())):[-15,60];if(this._topOffsetRange=h.length===2?h:[0,85],this._minDelay=this.getAttribute("min-delay")?Number(this.getAttribute("min-delay")):300,this._maxDelay=this.getAttribute("max-delay")?Number(this.getAttribute("max-delay"))<500?500:Number(this.getAttribute("max-delay")):800,this._slotType=this.getAttribute("slot-type")?this.getAttribute("slot-type"):"text",this._preferredReducedMotion){const l=this.getAttribute("init-num"),m=document.createDocumentFragment();this._sparkles=a(s(0,Number(l))).map(()=>u(this._preferredReducedMotion,this._randomColors)),this._sparkles.forEach(p=>{this.generateSparkle(p),m.appendChild(this.generateSparkle(p))}),this._sparklesBox.appendChild(m)}this.reCreate=this.reCreate.bind(this),this.mediaListener=this.mediaListener.bind(this)}generateSparkle(e){const t=document.createElement("span");return t.className="single-sparkle-box",t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="${e.size}" height="${e.size}" viewBox="0 0 160 160" fill="none"><path fill="currentColor" d="M80 0s4.285 41.292 21.496 58.504C118.707 75.715 160 80 160 80s-41.293 4.285-58.504 21.496S80 160 80 160s-4.285-41.293-21.496-58.504C41.292 84.285 0 80 0 80s41.292-4.285 58.504-21.496C75.715 41.292 80 0 80 0z"></path></svg>`,t.style.color=e.style.color,t.style.top=e.style.top,t.style.left=e.style.left,t.style.zIndex=e.style.zIndex,t.id=e.id,t}mediaListener(e){if(e&&(this._preferredReducedMotion=!e.matches,this._preferredReducedMotion))return c(this.reCreate,this._timeId,null,null);this._preferredReducedMotion||c(this.reCreate,this._timeId,this._minDelay,this._maxDelay)}reCreate(){const e=u(!1,this._randomColors,this._slotType,this._leftOffsetRange,this._topOffsetRange),t=Date.now(),i=this._sparkles.filter(h=>{if(t-h.createdAt<this._maxDelay+150)return!0;{const m=this._shadow.getElementById(h.id);return m&&this._sparklesBox.removeChild(m),!1}});this._sparklesBox.appendChild(this.generateSparkle(e)),i.push(e),this._sparkles=[...i]}connectedCallback(){this.mediaListener(),this._mediaQueryList.addEventListener?this._mediaQueryList.addEventListener("change",this.mediaListener):this._mediaQueryList.addListener(this.mediaListener)}disconnectCallback(){if(this._mediaQueryList.removeEventListener?this._mediaQueryList.removeEventListener("change",this.mediaListener):this._mediaQueryList.removeListener(this.mediaListener),typeof this._timeId=="number")return window.clearTimeout(this._timeId)}}if(d())customElements.define("a-sparkles",y);else throw new Error("仅在浏览器中可用")});
